{"version":3,"file":"useOuterCallback-QFNlztp2.js","sources":["../../../node_modules/react-cool-portal/dist/index.esm.js","../../../src/hooks/useOuterCallback.ts"],"sourcesContent":["import { useRef, useState, useEffect, useCallback } from 'react';\nimport { createPortal as createPortal$1 } from 'react-dom';\n\nvar useLatest = (function (val) {\n  var ref = useRef(val);\n  ref.current = val;\n  return ref;\n});\n\nvar delay = (function (cb, delay) {\n  if (delay === void 0) {\n    delay = 100;\n  }\n\n  var timer = setTimeout(function () {\n    clearTimeout(timer);\n    cb();\n  }, delay);\n});\n\nvar shouldHide = (function (arg) {\n  return Array.isArray(arg) ? arg.every(function (className) {\n    return !Array.from(document.getElementsByClassName(className)).length;\n  }) : arg;\n});\n\nvar createEl = function createEl(id) {\n  var el = document.createElement(\"div\");\n  el.setAttribute(\"id\", id);\n  document.body.appendChild(el);\n  return el;\n};\n\nvar createPortal = (function (id, autoRemoveContainer, isShow, clickOutsideCb, escCb) {\n  return function (_ref) {\n    var children = _ref.children;\n\n    var _useState = useState(),\n        container = _useState[0],\n        setContainer = _useState[1];\n\n    useEffect(function () {\n      if (!isShow) return function () {\n        return null;\n      };\n      setContainer(document.getElementById(id) || createEl(id));\n      return function () {\n        if (!container) return;\n        delay(function () {\n          if (autoRemoveContainer && container.innerHTML === \"\") container.remove();\n        });\n      };\n    }, [container]);\n    useEffect(function () {\n      if (!isShow || !container) return function () {\n        return null;\n      };\n      var isClickOutside = false;\n\n      var handleMouseDown = function handleMouseDown(e) {\n        isClickOutside = !container.contains(e.target);\n      };\n\n      var handleClick = function handleClick(e) {\n        // @ts-expect-error\n        if (isClickOutside) clickOutsideCb(e);\n      };\n\n      var handleKeyDown = function handleKeyDown(e) {\n        // @ts-expect-error\n        if (e.key === \"Escape\") escCb(e);\n      };\n\n      if (clickOutsideCb) {\n        document.addEventListener(\"mousedown\", handleMouseDown);\n        document.addEventListener(\"click\", handleClick);\n      }\n\n      if (escCb) document.addEventListener(\"keydown\", handleKeyDown);\n      return function () {\n        if (clickOutsideCb) {\n          document.removeEventListener(\"mousedown\", handleMouseDown);\n          document.removeEventListener(\"click\", handleClick);\n        }\n\n        if (escCb) document.removeEventListener(\"keydown\", handleKeyDown);\n      };\n    }, [container]);\n    return isShow && container ? /*#__PURE__*/createPortal$1(children, container) : null;\n  };\n});\n\n/* eslint-disable react-hooks/exhaustive-deps */\nvar defaultContainerId = \"react-cool-portal\";\n\nvar usePortal = function usePortal(_temp) {\n  var _ref = _temp === void 0 ? {} : _temp,\n      _ref$containerId = _ref.containerId,\n      containerId = _ref$containerId === void 0 ? defaultContainerId : _ref$containerId,\n      _ref$autoRemoveContai = _ref.autoRemoveContainer,\n      autoRemoveContainer = _ref$autoRemoveContai === void 0 ? true : _ref$autoRemoveContai,\n      _ref$defaultShow = _ref.defaultShow,\n      defaultShow = _ref$defaultShow === void 0 ? true : _ref$defaultShow,\n      _ref$clickOutsideToHi = _ref.clickOutsideToHide,\n      clickOutsideToHide = _ref$clickOutsideToHi === void 0 ? true : _ref$clickOutsideToHi,\n      _ref$escToHide = _ref.escToHide,\n      escToHide = _ref$escToHide === void 0 ? true : _ref$escToHide,\n      _ref$internalShowHide = _ref.internalShowHide,\n      internalShowHide = _ref$internalShowHide === void 0 ? true : _ref$internalShowHide,\n      onShow = _ref.onShow,\n      onHide = _ref.onHide;\n\n  var _useState = useState(defaultShow),\n      isShow = _useState[0],\n      setIsShow = _useState[1];\n\n  var skipClickOutsideRef = useRef(false);\n  var onShowRef = useLatest(onShow);\n  var onHideRef = useLatest(onHide); // Workaround: because handleHide() will cache \"isShow\" state\n\n  var isShowRef = useRef(defaultShow);\n  var setSkipClickOutside = useCallback(function () {\n    if (!clickOutsideToHide) return;\n    skipClickOutsideRef.current = true;\n    delay(function () {\n      skipClickOutsideRef.current = false;\n    });\n  }, [clickOutsideToHide]);\n  var show = useCallback(function (e) {\n    setSkipClickOutside();\n    if (isShowRef.current) return;\n    setIsShow(true);\n    isShowRef.current = true;\n    if (onShowRef.current) onShowRef.current(e);\n  }, [onShowRef, setSkipClickOutside]);\n  var hide = useCallback(function (e) {\n    setSkipClickOutside();\n    if (!isShowRef.current) return;\n    setIsShow(false);\n    isShowRef.current = false;\n    if (onHideRef.current) onHideRef.current(e);\n  }, [onHideRef, setSkipClickOutside]);\n  var toggle = useCallback(function (e) {\n    if (isShowRef.current) {\n      hide(e);\n    } else {\n      show(e);\n    }\n  }, [hide, show]);\n  var handleHide = useCallback(function (e) {\n    if (skipClickOutsideRef.current) return;\n    if (e.type === \"click\" && shouldHide(clickOutsideToHide) || e.type === \"keydown\" && shouldHide(escToHide)) hide(e);\n  }, [hide]);\n  var Portal = useCallback(createPortal(containerId, autoRemoveContainer, !internalShowHide || isShow, handleHide, handleHide), [internalShowHide, isShow]);\n  return {\n    Portal: Portal,\n    isShow: isShow,\n    show: show,\n    hide: hide,\n    toggle: toggle\n  };\n};\n\nexport { usePortal as default, defaultContainerId };\n","import React, { useEffect, useRef } from 'react';\n\nexport const useOuterClick = <E extends HTMLElement>(\n  callback: (e: React.MouseEvent) => void,\n): React.MutableRefObject<E> => {\n  const innerRef = useRef<E>(null);\n  const callbackRef = useRef(null);\n\n  // set current callback in ref, before second useEffect uses it\n  useEffect(() => {\n    // useEffect wrapper to be safe for concurrent mode\n    callbackRef.current = callback;\n  });\n\n  useEffect(() => {\n    // read most recent callback and innerRef dom node from refs\n    const fireCallback = (e: MouseEvent | KeyboardEvent): void => {\n      if (\n        innerRef.current &&\n        callbackRef.current &&\n        !innerRef.current.contains(e.target as Node) &&\n        document.body.contains(e.target as Node)\n      ) {\n        callbackRef.current(e);\n      }\n    };\n\n    const handleKeypress = (e: KeyboardEvent) => {\n      if (e.key === 'Escape') {\n        fireCallback(e);\n      }\n    };\n\n    document.addEventListener('keydown', handleKeypress);\n    document.addEventListener('click', fireCallback);\n\n    return () => {\n      document.removeEventListener('keydown', handleKeypress);\n      document.removeEventListener('click', fireCallback);\n    };\n  }, []);\n\n  return innerRef; // return ref; client can omit `useRef`\n};\n"],"names":["useLatest","val","ref","useRef","delay","cb","timer","shouldHide","arg","className","createEl","id","el","createPortal","autoRemoveContainer","isShow","clickOutsideCb","escCb","_ref","children","_useState","useState","container","setContainer","useEffect","isClickOutside","handleMouseDown","e","handleClick","handleKeyDown","createPortal$1","defaultContainerId","usePortal","_temp","_ref$containerId","containerId","_ref$autoRemoveContai","_ref$defaultShow","defaultShow","_ref$clickOutsideToHi","clickOutsideToHide","_ref$escToHide","escToHide","_ref$internalShowHide","internalShowHide","onShow","onHide","setIsShow","skipClickOutsideRef","onShowRef","onHideRef","isShowRef","setSkipClickOutside","useCallback","show","hide","toggle","handleHide","Portal","cov_2nlckbayre","s","innerRef","callbackRef","f","callback","current","key","fireCallback","addEventListener","contains","target","b","removeEventListener"],"mappings":"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","x_google_ignoreList":[0]}